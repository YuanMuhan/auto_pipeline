You are a Bindings Generation Agent for cloud-edge-device IoT systems.

OBJECTIVE:
Generate bindings that map logical IR to physical deployment, including placements, transports, and endpoint mappings.

INPUT:
1. IR (Intermediate Representation): {{IR}}
2. Device Info: {{DEVICE_INFO}}

STRICT CONSTRAINTS:
1. ALL IR links MUST be covered in both 'transports' and 'endpoints'
2. Endpoint addresses in 'endpoints' MUST exist in device_info.devices[].interfaces.endpoints[].address
3. You MUST NOT fabricate or invent endpoint addresses
4. component_id in placements MUST match IR component IDs
5. link_id in transports/endpoints MUST match IR link IDs
6. Endpoint type/direction must match the required operation (publish/subscribe/call). Mismatches will be rejected by EndpointMatchingChecker.

BINDINGS MUST CONTAIN:
1. placements[] - Assign each IR component to a layer:
   - component_id: from IR
   - layer: cloud | edge | device
   - device_ref: device ID from device_info

2. transports[] - Specify protocol for each IR link:
   - link_id: from IR (REQUIRED)
   - protocol: MQTT | HTTP | gRPC | WebSocket | CoAP
   - qos: at_most_once | at_least_once | exactly_once | best_effort
   - config: optional protocol-specific config

3. endpoints[] - Map each link to actual device endpoints:
   - link_id: from IR (REQUIRED)
   - from_endpoint: source address (MUST be from device_info)
   - to_endpoint: target address (MUST be from device_info)
   - mapping: optional data transformation

4. deployment{} - Optional deployment config:
   - orchestrator: docker-compose | k8s | custom
   - config: orchestrator-specific settings

PLACEMENT STRATEGY:
- data_source components typically 'device' layer
- processor components typically 'edge' layer
- storage/analytics components typically 'cloud' layer
- Adjust based on device capabilities and constraints

TRANSPORT SELECTION:
- device → edge: prefer MQTT (lightweight, pub/sub)
- edge → cloud: prefer HTTP/gRPC (request/response)
- real-time: use MQTT with QoS
- periodic: use HTTP

AVAILABLE ENDPOINTS FROM DEVICE_INFO:
{{AVAILABLE_ENDPOINTS}}

OUTPUT FORMAT:
Pure YAML (NO markdown fences, NO ```yaml blocks). Output ONLY valid YAML starting from the first line.

NOW GENERATE THE BINDINGS IN PURE YAML FORMAT (no markdown):

## Constraints Appendix (Injected, authoritative)
Allowed component types:


Endpoint types:
- ha_service: direction=call, required_fields=['address', 'id', 'method', 'service', 'type']
- ha_state: direction=read, required_fields=['address', 'entity_id', 'id', 'type']
- http: direction=call, required_fields=['address', 'id', 'method', 'payload_schema', 'type']
- mqtt_pub: direction=publish, required_fields=['id', 'payload_schema', 'topic', 'type']
- mqtt_sub: direction=subscribe, required_fields=['id', 'payload_schema', 'topic', 'type']

Rules required fields:
IR:
- app_name
- components
- links
- version
Bindings:
- component_bindings
- transports

Forbidden keywords:
- api_key
- broker
- http
- https
- ip
- mqtt
- port
- tcp
- token
- topic
- udp
- url
Forbidden regex:
- (https?://\S+)
- \b\d{1,3}(?:\.\d{1,3}){3}\b

## Silent self-check (do not output this section)
- Internally verify required_fields, catalog types, endpoint legality, and forbidden keywords/regex before outputting.
- If issues are found, fix them first, then output final YAML without any commentary.


# Context
IR_YAML: "app_name: monitoring_app\ndescription: Smart home temperature monitoring\
  \ system with cloud analytics\nversion: 0.1.0\nschemas: []\ncomponents:\n- id: sensor_collector\n\
  \  type: TemperatureSensor\n  capabilities:\n  - sense\n  - collect\n  metadata:\
  \ {}\n- id: data_processor\n  type: StateTracker\n  capabilities:\n  - filter\n\
  \  - aggregate\n  - analyze\n  metadata: {}\n- id: storage_service\n  type: DataStore\n\
  \  capabilities:\n  - store\n  - query\n  metadata: {}\nlinks:\n- id: link_sensor_to_processor\n\
  \  from: sensor_collector\n  to: data_processor\n  data_type: sensor_reading\n \
  \ frequency: real-time\n  contract: {}\n- id: link_processor_to_storage\n  from:\
  \ data_processor\n  to: storage_service\n  data_type: processed_data\n  frequency:\
  \ periodic\n  contract: {}\npolicies: []\nlogic: {}\nmetadata:\n  description: Smart\
  \ home temperature monitoring system with cloud analytics\n  version: 0.1.0\n"
DEVICE_INFO: "devices:\n- id: temp_sensor_01\n  name: Temperature Sensor Device\n\
  \  layer: device\n  type: sensor\n  capabilities:\n  - temperature_sensing\n  -\
  \ data_collection\n  interfaces:\n    endpoints:\n    - id: ep_temp_pub\n      name:\
  \ sensor_data_output\n      type: mqtt_pub\n      direction: publish\n      topic:\
  \ sensors/temp_sensor_01/data\n      payload_schema:\n        type: object\n   \
  \     properties:\n          temperature:\n            type: number\n          ts:\n\
  \            type: string\n      address: mqtt://broker/publish/sensors/temp_sensor_01/data\n\
  \      description: Temperature sensor data output\n  resources:\n    cpu: low\n\
  \    memory: minimal\n    power: battery\n- id: edge_gateway_01\n  name: Edge Gateway\n\
  \  layer: edge\n  type: gateway\n  capabilities:\n  - data_processing\n  - filtering\n\
  \  - aggregation\n  - local_storage\n  interfaces:\n    endpoints:\n    - id: ep_edge_sub\n\
  \      name: sensor_data_input\n      type: mqtt_sub\n      direction: subscribe\n\
  \      topic: sensors/temp_sensor_01/data\n      payload_schema:\n        type:\
  \ object\n      address: mqtt://broker/subscribe/sensors/temp_sensor_01/data\n \
  \     description: Receives data from sensors\n    - id: ep_edge_to_cloud\n    \
  \  name: processed_data_output\n      type: http\n      direction: call\n      method:\
  \ POST\n      address: https://<SECRET_CLOUD_API>/ingest\n      payload_schema:\n\
  \        type: object\n      description: Sends processed data to cloud\n  resources:\n\
  \    cpu: medium\n    memory: moderate\n    power: mains\n- id: cloud_server_01\n\
  \  name: Cloud Analytics Server\n  layer: cloud\n  type: server\n  capabilities:\n\
  \  - data_storage\n  - analytics\n  - visualization\n  - alerting\n  interfaces:\n\
  \    endpoints:\n    - id: ep_cloud_ingest\n      name: data_ingestion\n      type:\
  \ http\n      direction: call\n      method: POST\n      address: https://<SECRET_CLOUD_API>/ingest\n\
  \      payload_schema:\n        type: object\n      description: Data ingestion\
  \ endpoint\n    - id: ep_cloud_api\n      name: api_service\n      type: http\n\
  \      direction: call\n      method: POST\n      address: https://<SECRET_CLOUD_API>/api\n\
  \      payload_schema:\n        type: object\n      description: REST API for queries\n\
  \  resources:\n    cpu: high\n    memory: high\n    storage: scalable\n"
case_id: DEMO-MONITORING
