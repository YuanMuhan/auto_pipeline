{
  "case_id": "DEMO-SMARTHOME",
  "timestamp": "2026-01-11T19:08:45.682258",
  "checks": {
    "user_problem_schema": {
      "status": "PASS",
      "message": "OK"
    },
    "device_info_schema": {
      "status": "PASS",
      "message": "OK"
    },
    "device_info_catalog": {
      "status": "PASS",
      "message": "OK"
    },
    "plan_schema": {
      "status": "PASS",
      "message": "OK"
    },
    "ir_schema": {
      "status": "PASS",
      "message": "OK"
    },
    "ir_boundary": {
      "status": "PASS",
      "message": "OK"
    },
    "ir_component_catalog": {
      "status": "PASS",
      "message": "OK"
    },
    "ir_interface": {
      "status": "PASS",
      "message": "OK"
    },
    "bindings_schema": {
      "status": "PASS",
      "message": "OK"
    },
    "coverage": {
      "status": "PASS",
      "message": "OK"
    },
    "endpoint_legality": {
      "status": "PASS",
      "message": "OK"
    },
    "endpoint_matching": {
      "status": "PASS",
      "message": "OK"
    },
    "cross_artifact_consistency": {
      "status": "PASS",
      "message": "OK"
    },
    "semantic_proxy": {
      "status": "PASS",
      "message": "OK"
    },
    "code_generated": {
      "status": "PASS",
      "message": "OK"
    },
    "deploy_generated": {
      "status": "PASS",
      "message": "OK"
    },
    "generation_consistency": {
      "status": "PASS",
      "message": "OK"
    },
    "runtime_compose": {
      "status": "SKIP",
      "message": "OK"
    }
  },
  "metrics": {
    "num_components": 6,
    "num_entities": 6,
    "num_links": 5,
    "num_placements": 6,
    "num_layers": 3,
    "total_duration_ms": 12869,
    "total_attempts": 6,
    "attempts_by_stage": {
      "inputs": 1,
      "plan": 1,
      "ir": 1,
      "bindings": 1,
      "codegen": 1,
      "deploy": 1
    }
  },
  "overall_status": "PASS",
  "overall_static_status": "PASS",
  "overall_runtime_status": "SKIP",
  "stages_passed": [
    "plan",
    "ir",
    "bindings",
    "codegen",
    "deploy",
    "eval"
  ],
  "rules_version": {
    "ir_rules_hash": "047ca0d25ee6a7cd98cdd4e68af932f2f456879fc9ac62b28ebb8d99f1327bda",
    "bindings_rules_hash": "047ca0d25ee6a7cd98cdd4e68af932f2f456879fc9ac62b28ebb8d99f1327bda",
    "ir_required_fields": 4,
    "ir_forbidden_keywords": 12,
    "bindings_required_fields": 2,
    "bindings_forbidden_keywords": 0,
    "rules_source": "yaml"
  },
  "bindings_hash": "dfe38218e23782ae84a72d991ed046bcbb1efda2b4c2123a5176c6832ed7ac0d",
  "catalog_hashes": {
    "components_index_hash": "ba26c264fb48b9445d957bac399bb436826407143176f3fb0fad1dffd876fe78",
    "endpoint_types_hash": "5f566bd637fe54bc64c37b48c279b10e38490d8ce2a4b152cb5cfb68594be6e2"
  },
  "validators": {
    "user_problem_schema": {
      "pass": true,
      "failures": [],
      "warnings": [
        "UserProblem soft-missing fields: id, title, target"
      ],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "device_info_schema": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "device_info_catalog": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "plan_schema": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "ir_schema": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "ir_boundary": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "ir_component_catalog": {
      "pass": true,
      "failures": [],
      "warnings": [
        "alias target not resolved: RuleEngine (candidates=[])",
        "alias target not resolved: RuleEngine (candidates=[])",
        "alias target not resolved: RuleEngine (candidates=[])",
        "alias target not resolved: StateTracker (candidates=[])",
        "normalized component edge_gateway_ha type controller -> RuleEngine",
        "normalized component cloud_automation_service type processor -> RuleEngine",
        "IR component types not in catalog: data_source, data_source, actuator, storage (open mode: treated as warning)",
        "component door_sensor_main type 'data_source' has no catalog spec; skip port validation",
        "component motion_sensor_living type 'data_source' has no catalog spec; skip port validation",
        "component smart_light_living type 'actuator' has no catalog spec; skip port validation",
        "component edge_gateway_ha has no explicit ports; skipping port validation",
        "component cloud_automation_service has no explicit ports; skipping port validation",
        "component cloud_storage_service type 'storage' has no catalog spec; skip port validation",
        "link door_sensor_to_gateway missing explicit ports; skipping port validation",
        "link motion_sensor_to_gateway missing explicit ports; skipping port validation",
        "link gateway_to_cloud_service missing explicit ports; skipping port validation",
        "link cloud_service_to_storage missing explicit ports; skipping port validation",
        "link cloud_service_to_light missing explicit ports; skipping port validation"
      ],
      "metrics": {
        "unknown_types": [
          {
            "id": "door_sensor_main",
            "type": "data_source"
          },
          {
            "id": "motion_sensor_living",
            "type": "data_source"
          },
          {
            "id": "smart_light_living",
            "type": "actuator"
          },
          {
            "id": "cloud_storage_service",
            "type": "storage"
          }
        ],
        "unknown_types_count": 4
      },
      "status": "PASS",
      "skipped": false
    },
    "ir_interface": {
      "pass": true,
      "failures": [],
      "warnings": [
        "alias target not resolved: RuleEngine (candidates=[])",
        "alias target not resolved: RuleEngine (candidates=[])",
        "alias target not resolved: RuleEngine (candidates=[])",
        "alias target not resolved: StateTracker (candidates=[])",
        "IR component types not in catalog: data_source, data_source, actuator, storage (open mode: treated as warning)",
        "component door_sensor_main type 'data_source' has no catalog spec; skip port validation",
        "component motion_sensor_living type 'data_source' has no catalog spec; skip port validation",
        "component smart_light_living type 'actuator' has no catalog spec; skip port validation",
        "component edge_gateway_ha has no explicit ports; skipping port validation",
        "component cloud_automation_service has no explicit ports; skipping port validation",
        "component cloud_storage_service type 'storage' has no catalog spec; skip port validation",
        "link door_sensor_to_gateway missing explicit ports; skipping port validation",
        "link motion_sensor_to_gateway missing explicit ports; skipping port validation",
        "link gateway_to_cloud_service missing explicit ports; skipping port validation",
        "link cloud_service_to_storage missing explicit ports; skipping port validation",
        "link cloud_service_to_light missing explicit ports; skipping port validation"
      ],
      "metrics": {
        "unknown_types": [
          {
            "id": "door_sensor_main",
            "type": "data_source"
          },
          {
            "id": "motion_sensor_living",
            "type": "data_source"
          },
          {
            "id": "smart_light_living",
            "type": "actuator"
          },
          {
            "id": "cloud_storage_service",
            "type": "storage"
          }
        ],
        "unknown_types_count": 4
      },
      "status": "PASS",
      "skipped": false
    },
    "bindings_schema": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "coverage": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {
        "coverage_ratio": 1.0
      },
      "status": "PASS",
      "skipped": false
    },
    "endpoint_legality": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {
        "referenced": 5,
        "invalid": 0
      },
      "status": "PASS",
      "skipped": false
    },
    "endpoint_matching": {
      "pass": true,
      "failures": [],
      "warnings": [
        "link door_sensor_to_gateway: endpoint ha://local type 'ha_state' uncommon as source",
        "link door_sensor_to_gateway: endpoint mqtt://ha_broker/homeassistant/commands type 'mqtt_pub' uncommon as sink",
        "link motion_sensor_to_gateway: endpoint ha://local type 'ha_state' uncommon as source",
        "link motion_sensor_to_gateway: endpoint mqtt://ha_broker/homeassistant/commands type 'mqtt_pub' uncommon as sink",
        "link cloud_service_to_light: endpoint http://<SECRET_HA_HOST>:8123/api/services/light/turn_on type 'ha_service' uncommon as sink"
      ],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "cross_artifact_consistency": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "code_generated": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "deploy_generated": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "generation_consistency": {
      "pass": true,
      "failures": [],
      "warnings": [],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "semantic_proxy": {
      "pass": true,
      "failures": [],
      "warnings": [
        {
          "code": "W_UP_DI_DEVICE_NOT_FOUND",
          "stage": "semantic",
          "checker": "SemanticProxyChecker",
          "message": "User problem mentions devices not found in device_info",
          "details": {
            "up_terms": [
              "传感器事件实时响应（<500ms），通知推送（<2s）",
              "传感器事件流：10-50 events/min，状态查询：低频",
              "智能家居安防自动化系统：门磁和人体传感器联动夜间照明，异常情况实时通知，支持离家模式和安防策略",
              "离家模式需要认证，敏感数据加密传输",
              "高可用性，支持传感器故障降级"
            ],
            "di_devices": [
              "cloud_automation_service",
              "cloud_storage_service",
              "door_sensor_main",
              "edge_gateway_ha",
              "home assistant 边缘网关",
              "motion_sensor_living",
              "smart_light_living",
              "主卧门磁传感器",
              "云端存储服务",
              "云端自动化服务",
              "客厅人体传感器",
              "客厅智能灯"
            ],
            "unmatched": [
              "传感器事件实时响应（<500ms），通知推送（<2s）",
              "传感器事件流：10-50 events/min，状态查询：低频",
              "智能家居安防自动化系统：门磁和人体传感器联动夜间照明，异常情况实时通知，支持离家模式和安防策略",
              "离家模式需要认证，敏感数据加密传输",
              "高可用性，支持传感器故障降级"
            ]
          }
        },
        {
          "code": "W_DI_UNUSED_ENDPOINTS",
          "stage": "semantic",
          "checker": "SemanticProxyChecker",
          "message": "Most device_info endpoints are unused in bindings",
          "details": {
            "di_endpoints": 6,
            "used_endpoints": 0,
            "ratio": 0.0
          }
        },
        {
          "code": "W_PLAN_IR_MISMATCH",
          "stage": "semantic",
          "checker": "SemanticProxyChecker",
          "message": "Plan and IR components diverge",
          "details": {
            "plan_refs": [
              "automation_engine",
              "data_recorder",
              "door_monitor",
              "lighting_controller",
              "motion_detector",
              "notification_service"
            ],
            "ir_components": [
              "door_sensor_main",
              "motion_sensor_living",
              "smart_light_living",
              "edge_gateway_ha",
              "cloud_automation_service",
              "cloud_storage_service"
            ],
            "missing_in_ir": [
              "automation_engine",
              "data_recorder",
              "door_monitor",
              "lighting_controller",
              "motion_detector",
              "notification_service"
            ],
            "unused_in_plan": [
              "cloud_automation_service",
              "cloud_storage_service",
              "door_sensor_main",
              "edge_gateway_ha",
              "motion_sensor_living",
              "smart_light_living"
            ]
          }
        },
        {
          "code": "W_MULTI_LAYER_WEAK",
          "stage": "semantic",
          "checker": "SemanticProxyChecker",
          "message": "Hints suggest multi-layer but artifacts show single/unknown layer",
          "details": {
            "hint_sources": [
              "di"
            ],
            "observed_layers": []
          }
        }
      ],
      "metrics": {},
      "status": "PASS",
      "skipped": false
    },
    "runtime_compose": {
      "pass": true,
      "failures": [],
      "warnings": [
        "Runtime check disabled"
      ],
      "metrics": {},
      "status": "SKIP",
      "skipped": true
    }
  },
  "failures_flat": [],
  "pipeline": {
    "stages": {
      "inputs": {
        "pass": true,
        "duration_ms": 29,
        "attempts": 1
      },
      "plan": {
        "pass": true,
        "duration_ms": 9,
        "attempts": 1
      },
      "ir": {
        "pass": true,
        "duration_ms": 6625,
        "attempts": 1
      },
      "bindings": {
        "pass": true,
        "duration_ms": 6201,
        "attempts": 1
      },
      "codegen": {
        "pass": true,
        "duration_ms": 5,
        "attempts": 1
      },
      "deploy": {
        "pass": true,
        "duration_ms": 0,
        "attempts": 1
      },
      "eval": {
        "pass": true,
        "duration_ms": 20,
        "attempts": 1
      }
    },
    "config": {
      "provider": "openai",
      "model": "gpt-4o-mini",
      "temperature": 0.0,
      "max_tokens": null,
      "cache_enabled": false,
      "prompt_tier": "P1",
      "seed": 0,
      "enable_repair": true,
      "enable_catalog": true,
      "runtime_check": false,
      "cache_dir": ".cache/llm",
      "run_id": "run=20260111_190832_1f76fd",
      "output_dir": ".\\outputs_temp_repair\\DEMO-SMARTHOME\\run=20260111_190832_1f76fd",
      "inputs": {
        "user_problem_path": "inputs\\user_problem.json",
        "device_info_path": "inputs\\device_info.json"
      },
      "semantic_warnings": true,
      "gate_mode": "core"
    }
  },
  "llm": {
    "provider": "openai",
    "model": "gpt-4o-mini",
    "temperature": 0.0,
    "cache_dir": ".cache/llm",
    "cache_enabled": false,
    "calls_total": 2,
    "calls_by_stage": {
      "generate_ir": 1,
      "generate_bindings": 1
    },
    "cache_hits": 0,
    "cache_misses": 2,
    "usage_tokens_total": 7008,
    "prompt_template_hashes": {
      "ir_agent": "e988f6f5eb10fce607fe03bd6543800fe7e096c1f4214b32812195d5dcc40a02",
      "binding_agent": "2e74f8041aef97687739748f6c25be75b4a4268e32d68ac268ee49306d7f944e"
    },
    "prompt_resolved_hashes": {
      "ir_agent": "229d4321d22c9d4f4f7815594097e9e4b7839a20ba1dd6109c9d06b15bb347cf",
      "binding_agent": "3f1e0ffb81d09105623403cf24d3bb5f13d9b4e949cbcfc0f3a92de1ebe08247"
    },
    "prompt_injections": {
      "catalog_types_hash": "7c0d7d6f58c2913592087dd9b3df67c63fc952388dc74d0606b92393079423a7",
      "endpoint_types_hash": "f7254349ed46bebfcce4f42c6e1ad57cb6d856e1c234d5aa4747451d26b72164",
      "rules_bundle_hash": "da37953ebf7e85a683b02a6ff8178eab41a34f1fed4ddb1663c9e38e8db5008e",
      "schema_required_hash": "92f48a7255d950725fa7f42ae07871e07d94b908de5c96001620c102c3db62ad"
    },
    "rules_hash": "477af2e4c423e9f8ac2603f6814562cc5efe0d6ddd24c8cfbdac784025672076",
    "schema_hashes": {
      "plan_schema": "8d8399a603d1b200692b2f75170ce1bbf742b5051503966cfee3aae1fcedcd9c",
      "ir_schema": "d1b20ea900cec23d6966c056a65ba93f30671c40bfe3737fa7fdaaa48d330fbb",
      "bindings_schema": "16e635d1178c71dabaf7ed996785e535b597198dbc2545cfa0372db633c0a640"
    },
    "raw_paths": {
      "generate_ir": [
        "outputs_temp_repair\\DEMO-SMARTHOME\\run=20260111_190832_1f76fd\\DEMO-SMARTHOME\\llm_raw\\generate_ir_attempt1.txt"
      ],
      "generate_bindings": [
        "outputs_temp_repair\\DEMO-SMARTHOME\\run=20260111_190832_1f76fd\\DEMO-SMARTHOME\\llm_raw\\generate_bindings_attempt1.txt"
      ]
    },
    "rules_source": "yaml"
  },
  "repair_trace": [],
  "generated_manifest_present": true,
  "generation_consistency_pass": true,
  "overall_core_status": "PASS",
  "overall_exec_status": "PASS",
  "input_validation": [
    "UserProblem warning: UserProblem soft-missing fields: id, title, target"
  ],
  "unknown_component_types_count": 4,
  "unknown_component_types": [
    {
      "id": "door_sensor_main",
      "type": "data_source"
    },
    {
      "id": "motion_sensor_living",
      "type": "data_source"
    },
    {
      "id": "smart_light_living",
      "type": "actuator"
    },
    {
      "id": "cloud_storage_service",
      "type": "storage"
    }
  ]
}