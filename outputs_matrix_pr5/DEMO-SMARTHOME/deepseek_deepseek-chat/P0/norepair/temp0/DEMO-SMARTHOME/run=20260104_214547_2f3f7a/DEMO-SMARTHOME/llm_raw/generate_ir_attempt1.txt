components:
  - id: door_sensor
    type: data_source
    capabilities:
      - sense
      - collect
    metadata:
      logical_role: detect_open_close
  - id: motion_sensor
    type: data_source
    capabilities:
      - sense
      - collect
    metadata:
      logical_role: detect_motion
  - id: smart_light
    type: actuator
    capabilities:
      - actuate
    metadata:
      logical_role: control_light
  - id: edge_gateway
    type: controller
    capabilities:
      - aggregate
      - analyze
      - decide
    metadata:
      logical_role: event_processing_and_automation
  - id: cloud_automation_service
    type: controller
    capabilities:
      - analyze
      - decide
      - notify
    metadata:
      logical_role: rule_engine_and_notification
  - id: cloud_storage_service
    type: storage
    capabilities:
      - store
      - query
    metadata:
      logical_role: historical_data_storage

links:
  - id: door_state_to_edge
    from: door_sensor
    to: edge_gateway
    data_type: sensor_reading
    contract:
      data: door_state
      format: binary
    frequency: real-time
  - id: motion_state_to_edge
    from: motion_sensor
    to: edge_gateway
    data_type: sensor_reading
    contract:
      data: motion_state
      format: binary
    frequency: real-time
  - id: edge_light_control
    from: edge_gateway
    to: smart_light
    data_type: command
    contract:
      action: turn_on_off
    frequency: on-demand
  - id: edge_events_to_cloud
    from: edge_gateway
    to: cloud_automation_service
    data_type: event
    contract:
      type: sensor_event_or_system_status
    frequency: real-time
  - id: cloud_notification
    from: cloud_automation_service
    to: external_notification_sink
    data_type: notification
    contract:
      priority: high_or_normal
    frequency: on-demand
  - id: cloud_data_to_storage
    from: cloud_automation_service
    to: cloud_storage_service
    data_type: aggregated_data
    contract:
      content: event_history_and_system_status
    frequency: periodic
  - id: storage_query
    from: cloud_storage_service
    to: external_query_source
    data_type: query_result
    contract:
      content: historical_records
    frequency: on-demand
  - id: sensor_health_to_edge
    from: door_sensor
    to: edge_gateway
    data_type: status
    contract:
      data: device_health
    frequency: periodic
  - id: sensor_health_to_edge_2
    from: motion_sensor
    to: edge_gateway
    data_type: status
    contract:
      data: device_health
    frequency: periodic

logic:
  modes:
    home_mode:
      condition: time_between_22_00_and_06_00 AND motion_detected
      action: turn_on_light
      deactivation: no_motion_for_5_minutes
    away_mode:
      condition: door_state_changed OR motion_detected
      action: send_alert_notification
      priority: motion_detected_high_priority
    security_mode:
      condition: door_state_changed AND motion_detected
      action: trigger_alarm_and_record
      escalation: consecutive_anomalies_notify_emergency_contact
  fault_tolerance:
    sensor_offline: use_fallback_policy
    system_degradation: graceful_downgrade

metadata:
  description: Logical IR for a smart home security automation system with door/motion sensors, lighting control, and cloud notification/storage.
  version: "1.0"
  system: smart_home_security_automation