app_name: automation_app
component_bindings: []
deployment:
  orchestrator: docker-compose
endpoints:
- from_endpoint: ha://local
  link_id: door_state_to_edge
  to_endpoint: mqtt://ha_broker/homeassistant/events/#
- from_endpoint: ha://local
  link_id: motion_state_to_edge
  to_endpoint: mqtt://ha_broker/homeassistant/events/#
- from_endpoint: mqtt://ha_broker/homeassistant/commands
  link_id: edge_to_light_control_home
  to_endpoint: http://<SECRET_HA_HOST>:8123/api/services/light/turn_on
- from_endpoint: mqtt://ha_broker/homeassistant/commands
  link_id: edge_to_cloud_events
  to_endpoint: https://<SECRET_CLOUD_API>/api/v1/events
- from_endpoint: mqtt://ha_broker/homeassistant/commands
  link_id: edge_to_cloud_storage
  to_endpoint: https://<SECRET_CLOUD_DB>/write?db=smarthome&precision=s
- from_endpoint: https://<SECRET_CLOUD_API>/api/v1/events
  link_id: scheduler_to_edge
  to_endpoint: http://<SECRET_HA_HOST>:8123/api/webhook/<SECRET_WEBHOOK_ID>
- from_endpoint: mqtt://ha_broker/homeassistant/commands
  link_id: edge_to_security_controller
  to_endpoint: https://<SECRET_CLOUD_API>/api/v1/events
- from_endpoint: https://<SECRET_CLOUD_API>/api/v1/events
  link_id: security_to_notifier
  to_endpoint: https://api.pushover.net/1/messages.json?token=<SECRET_PUSHOVER_TOKEN>
- from_endpoint: https://<SECRET_CLOUD_API>/api/v1/events
  link_id: cloud_query_to_storage
  to_endpoint: https://<SECRET_CLOUD_DB>/query?db=smarthome
placements:
- component_id: door_sensor_main
  device_ref: door_sensor_main
  layer: device
- component_id: motion_sensor_living
  device_ref: motion_sensor_living
  layer: device
- component_id: smart_light_living
  device_ref: smart_light_living
  layer: device
- component_id: edge_gateway_ha
  device_ref: edge_gateway_ha
  layer: edge
- component_id: cloud_automation_service
  device_ref: cloud_automation_service
  layer: cloud
- component_id: cloud_storage_service
  device_ref: cloud_storage_service
  layer: cloud
- component_id: system_scheduler
  device_ref: cloud_automation_service
  layer: cloud
- component_id: security_controller
  device_ref: cloud_automation_service
  layer: cloud
transports:
- link_id: door_state_to_edge
  protocol: MQTT
  qos: at_least_once
- link_id: motion_state_to_edge
  protocol: MQTT
  qos: at_least_once
- link_id: edge_to_light_control_home
  protocol: MQTT
  qos: at_least_once
- link_id: edge_to_cloud_events
  protocol: HTTP
  qos: best_effort
- link_id: edge_to_cloud_storage
  protocol: HTTP
  qos: best_effort
- link_id: scheduler_to_edge
  protocol: HTTP
  qos: best_effort
- link_id: edge_to_security_controller
  protocol: HTTP
  qos: at_least_once
- link_id: security_to_notifier
  protocol: HTTP
  qos: at_least_once
- link_id: cloud_query_to_storage
  protocol: HTTP
  qos: best_effort
version: 0.1.0
