{
  "devices": [
    {
      "id": "door_sensor_main",
      "name": "主卧门磁传感器",
      "layer": "device",
      "type": "binary_sensor",
      "capabilities": ["detect_open_close", "battery_powered", "zigbee"],
      "interfaces": {
        "endpoints": [
          {
            "id": "ep_door_main_state",
            "name": "门磁状态输出",
            "kind": "output",
            "address": "ha_entity://binary_sensor.bedroom_door_contact",
            "protocol": "home_assistant_state",
            "ops": ["read_state", "subscribe_changes"],
            "schema": {
              "state": ["on", "off"],
              "attributes": ["battery", "last_changed"]
            },
            "description": "Home Assistant 门磁实体状态"
          }
        ]
      },
      "resources": {
        "cpu": "minimal",
        "memory": "minimal",
        "power": "battery",
        "network": "zigbee"
      }
    },
    {
      "id": "motion_sensor_living",
      "name": "客厅人体传感器",
      "layer": "device",
      "type": "motion_sensor",
      "capabilities": ["detect_motion", "illuminance_sensing", "battery_powered"],
      "interfaces": {
        "endpoints": [
          {
            "id": "ep_motion_living_state",
            "name": "人体活动检测输出",
            "kind": "output",
            "address": "ha_entity://binary_sensor.living_room_motion",
            "protocol": "home_assistant_state",
            "ops": ["read_state", "subscribe_changes"],
            "schema": {
              "state": ["on", "off"],
              "attributes": ["illuminance", "battery"]
            },
            "description": "Home Assistant 人体传感器实体"
          }
        ]
      },
      "resources": {
        "cpu": "minimal",
        "memory": "minimal",
        "power": "battery"
      }
    },
    {
      "id": "smart_light_living",
      "name": "客厅智能灯",
      "layer": "device",
      "type": "actuator_light",
      "capabilities": ["turn_on_off", "dimming", "color_temp"],
      "interfaces": {
        "endpoints": [
          {
            "id": "ep_light_control",
            "name": "灯光控制接口",
            "kind": "input",
            "address": "ha_service://light.living_room_main",
            "protocol": "home_assistant_service",
            "ops": ["turn_on", "turn_off", "set_brightness", "set_color_temp"],
            "schema": {
              "service": ["light.turn_on", "light.turn_off"],
              "data": {
                "brightness": "0-255",
                "color_temp": "153-500"
              }
            },
            "description": "Home Assistant 灯光服务调用"
          }
        ]
      },
      "resources": {
        "cpu": "low",
        "memory": "low",
        "power": "mains"
      }
    },
    {
      "id": "edge_gateway_ha",
      "name": "Home Assistant 边缘网关",
      "layer": "edge",
      "type": "gateway_homeassistant",
      "capabilities": ["event_bus", "automation", "state_management", "mqtt_broker"],
      "interfaces": {
        "endpoints": [
          {
            "id": "ep_ha_mqtt_sub",
            "name": "MQTT 订阅接口",
            "kind": "input",
            "address": "mqtt://ha_broker/homeassistant/events/#",
            "protocol": "MQTT",
            "ops": ["subscribe"],
            "description": "Home Assistant 内部 MQTT 事件总线（订阅）"
          },
          {
            "id": "ep_ha_mqtt_pub",
            "name": "MQTT 发布接口",
            "kind": "output",
            "address": "mqtt://ha_broker/homeassistant/commands",
            "protocol": "MQTT",
            "ops": ["publish"],
            "description": "Home Assistant MQTT 命令发布"
          },
          {
            "id": "ep_ha_webhook_in",
            "name": "Webhook 接收接口",
            "kind": "input",
            "address": "http://<SECRET_HA_HOST>:8123/api/webhook/<SECRET_WEBHOOK_ID>",
            "protocol": "HTTP",
            "ops": ["POST"],
            "description": "接收云端推送的配置/命令"
          }
        ]
      },
      "resources": {
        "cpu": "medium",
        "memory": "2GB",
        "storage": "32GB",
        "power": "mains"
      }
    },
    {
      "id": "cloud_automation_service",
      "name": "云端自动化服务",
      "layer": "cloud",
      "type": "server_automation",
      "capabilities": ["rule_engine", "notification", "data_storage", "analytics"],
      "interfaces": {
        "endpoints": [
          {
            "id": "ep_cloud_event_ingest",
            "name": "事件接收接口",
            "kind": "input",
            "address": "https://<SECRET_CLOUD_API>/api/v1/events",
            "protocol": "HTTP",
            "ops": ["POST"],
            "schema": {
              "event_type": "string",
              "payload": "object",
              "timestamp": "ISO8601"
            },
            "description": "接收边缘网关上报的事件"
          },
          {
            "id": "ep_cloud_notify_out",
            "name": "通知推送接口",
            "kind": "output",
            "address": "https://api.pushover.net/1/messages.json?token=<SECRET_PUSHOVER_TOKEN>",
            "protocol": "HTTP",
            "ops": ["POST"],
            "description": "推送通知到移动设备（Pushover API）"
          }
        ]
      },
      "resources": {
        "cpu": "scalable",
        "memory": "scalable",
        "storage": "scalable",
        "power": "datacenter"
      }
    },
    {
      "id": "cloud_storage_service",
      "name": "云端存储服务",
      "layer": "cloud",
      "type": "server_database",
      "capabilities": ["time_series_db", "query", "aggregation"],
      "interfaces": {
        "endpoints": [
          {
            "id": "ep_cloud_db_write",
            "name": "时序数据写入",
            "kind": "input",
            "address": "https://<SECRET_CLOUD_DB>/write?db=smarthome&precision=s",
            "protocol": "HTTP",
            "ops": ["POST"],
            "description": "InfluxDB 时序数据写入接口"
          },
          {
            "id": "ep_cloud_db_query",
            "name": "数据查询接口",
            "kind": "bidirectional",
            "address": "https://<SECRET_CLOUD_DB>/query?db=smarthome",
            "protocol": "HTTP",
            "ops": ["GET", "POST"],
            "description": "InfluxDB 查询接口"
          }
        ]
      },
      "resources": {
        "cpu": "high",
        "memory": "high",
        "storage": "1TB+"
      }
    }
  ],
  "metadata": {
    "note": "所有 <SECRET_*> 占位符在实际部署时需替换为真实凭证",
    "endpoint_count": 9,
    "layers": {
      "device": 3,
      "edge": 1,
      "cloud": 2
    }
  }
}
